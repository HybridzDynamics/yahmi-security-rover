<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yahmi Security Rover - Login</title>
    <link rel="stylesheet" href="css/yahmi-style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="login-page">
    <div class="login-container">
        <div class="login-card">
            <div class="login-header">
                <div class="brand-logo">
                    <i class="fas fa-shield-halved"></i>
                </div>
                <div class="brand-text">
                    <h1>Yahmi</h1>
                    <span>Security Rover</span>
                </div>
            </div>
            
            <div class="login-tabs">
                <button class="tab-btn active" data-tab="login">Login</button>
                <button class="tab-btn" data-tab="register">Register</button>
                <button class="tab-btn" data-tab="reset">Reset Password</button>
            </div>
            
            <!-- Login Form -->
            <form id="loginForm" class="login-form active">
                <div class="form-group">
                    <label for="loginUsername">Username</label>
                    <div class="input-group">
                        <i class="fas fa-user"></i>
                        <input type="text" id="loginUsername" name="username" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <div class="input-group">
                        <i class="fas fa-lock"></i>
                        <input type="password" id="loginPassword" name="password" required>
                        <button type="button" class="password-toggle" onclick="togglePassword('loginPassword')">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                
                <div class="form-options">
                    <label class="checkbox-label">
                        <input type="checkbox" name="rememberMe">
                        <span class="checkmark"></span>
                        Remember me
                    </label>
                    <a href="#" class="forgot-password" onclick="showTab('reset')">Forgot password?</a>
                </div>
                
                <button type="submit" class="btn btn-primary btn-full">
                    <i class="fas fa-sign-in-alt"></i>
                    Login
                </button>
            </form>
            
            <!-- Register Form -->
            <form id="registerForm" class="login-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="registerFirstName">First Name</label>
                        <div class="input-group">
                            <i class="fas fa-user"></i>
                            <input type="text" id="registerFirstName" name="firstName" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="registerLastName">Last Name</label>
                        <div class="input-group">
                            <i class="fas fa-user"></i>
                            <input type="text" id="registerLastName" name="lastName" required>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="registerEmail">Email</label>
                    <div class="input-group">
                        <i class="fas fa-envelope"></i>
                        <input type="email" id="registerEmail" name="email" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="registerUsername">Username</label>
                    <div class="input-group">
                        <i class="fas fa-user"></i>
                        <input type="text" id="registerUsername" name="username" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="registerPassword">Password</label>
                    <div class="input-group">
                        <i class="fas fa-lock"></i>
                        <input type="password" id="registerPassword" name="password" required>
                        <button type="button" class="password-toggle" onclick="togglePassword('registerPassword')">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="registerConfirmPassword">Confirm Password</label>
                    <div class="input-group">
                        <i class="fas fa-lock"></i>
                        <input type="password" id="registerConfirmPassword" name="confirmPassword" required>
                        <button type="button" class="password-toggle" onclick="togglePassword('registerConfirmPassword')">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                
                <div class="form-options">
                    <label class="checkbox-label">
                        <input type="checkbox" name="terms" required>
                        <span class="checkmark"></span>
                        I agree to the <a href="#" class="link">Terms of Service</a>
                    </label>
                </div>
                
                <button type="submit" class="btn btn-primary btn-full">
                    <i class="fas fa-user-plus"></i>
                    Register
                </button>
            </form>
            
            <!-- Reset Password Form -->
            <form id="resetForm" class="login-form">
                <div class="form-group">
                    <label for="resetEmail">Email Address</label>
                    <div class="input-group">
                        <i class="fas fa-envelope"></i>
                        <input type="email" id="resetEmail" name="email" required>
                    </div>
                </div>
                
                <div class="form-info">
                    <p>Enter your email address and we'll send you a link to reset your password.</p>
                </div>
                
                <button type="submit" class="btn btn-primary btn-full">
                    <i class="fas fa-paper-plane"></i>
                    Send Reset Link
                </button>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="showTab('login')">
                        <i class="fas fa-arrow-left"></i>
                        Back to Login
                    </button>
                </div>
            </form>
        </div>
        
        <div class="login-footer">
            <p>&copy; 2024 Yahmi Security Systems. All rights reserved.</p>
            <div class="footer-links">
                <a href="#">Privacy Policy</a>
                <a href="#">Terms of Service</a>
                <a href="#">Support</a>
            </div>
        </div>
    </div>
    
    <!-- Notifications -->
    <div id="notifications" class="notifications-container"></div>
    
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",
            authDomain: "yahmi-security-rover.firebaseapp.com",
            projectId: "yahmi-security-rover",
            storageBucket: "yahmi-security-rover.appspot.com",
            messagingSenderId: "123456789012",
            appId: "1:123456789012:web:abcdefghijklmnop"
        };
        
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        
        // Make Firebase available globally
        window.firebaseAuth = auth;
        
        // Authentication state listener
        onAuthStateChanged(auth, (user) => {
            if (user) {
                console.log('User signed in:', user);
                // Redirect to dashboard
                window.location.href = '/';
            }
        });
        
        // Firebase authentication functions
        window.firebaseAuthFunctions = {
            signIn: async (email, password) => {
                try {
                    const userCredential = await signInWithEmailAndPassword(auth, email, password);
                    return { success: true, user: userCredential.user };
                } catch (error) {
                    return { success: false, error: error.message };
                }
            },
            
            signUp: async (email, password, displayName) => {
                try {
                    const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                    return { success: true, user: userCredential.user };
                } catch (error) {
                    return { success: false, error: error.message };
                }
            },
            
            signOut: async () => {
                try {
                    await signOut(auth);
                    return { success: true };
                } catch (error) {
                    return { success: false, error: error.message };
                }
            }
        };
    </script>
    
    <!-- Scripts -->
    <script src="js/yahmi-auth.js"></script>
    <script>
        // Tab switching functionality
        function showTab(tabName) {
            // Hide all forms
            document.querySelectorAll('.login-form').forEach(form => {
                form.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected form
            document.getElementById(tabName + 'Form').classList.add('active');
            
            // Add active class to selected tab
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
        }
        
        // Password toggle functionality
        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            const button = input.nextElementSibling;
            const icon = button.querySelector('i');
            
            if (input.type === 'password') {
                input.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                input.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        }
        
        // Tab button event listeners
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const tabName = btn.dataset.tab;
                showTab(tabName);
            });
        });
        
        // Form submission handlers
        document.addEventListener('DOMContentLoaded', () => {
            // Login form
            document.getElementById('loginForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const formData = new FormData(e.target);
                const email = formData.get('username'); // Using username field for email
                const password = formData.get('password');
                
                if (window.firebaseAuthFunctions) {
                    const result = await window.firebaseAuthFunctions.signIn(email, password);
                    if (result.success) {
                        showNotification('Login successful!', 'success');
                        setTimeout(() => window.location.href = '/', 1000);
                    } else {
                        showNotification(result.error, 'error');
                    }
                } else {
                    showNotification('Firebase not initialized', 'error');
                }
            });
            
            // Register form
            document.getElementById('registerForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const formData = new FormData(e.target);
                const email = formData.get('email');
                const password = formData.get('password');
                const confirmPassword = formData.get('confirmPassword');
                const firstName = formData.get('firstName');
                const lastName = formData.get('lastName');
                
                if (password !== confirmPassword) {
                    showNotification('Passwords do not match', 'error');
                    return;
                }
                
                if (window.firebaseAuthFunctions) {
                    const result = await window.firebaseAuthFunctions.signUp(email, password, `${firstName} ${lastName}`);
                    if (result.success) {
                        showNotification('Registration successful!', 'success');
                        setTimeout(() => window.location.href = '/', 1000);
                    } else {
                        showNotification(result.error, 'error');
                    }
                } else {
                    showNotification('Firebase not initialized', 'error');
                }
            });
            
            // Reset password form
            document.getElementById('resetForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const formData = new FormData(e.target);
                const email = formData.get('email');
                
                // For now, just show a message
                showNotification('Password reset email sent (simulation)', 'info');
            });
        });
        
        // Notification function
        function showNotification(message, type) {
            const notifications = document.getElementById('notifications');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            notifications.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 5000);
        }
    </script>
</body>
</html>
